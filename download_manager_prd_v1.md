
# Chrome 下载文件管理插件（MVP）需求文档

## 1. 产品定位

**一个浏览器插件弹窗（Popup）**，用于：

* 快速查看最近下载
* 快速搜索 / 筛选
* 对下载项做最常用的操作（打开、定位、清理、重试）

> 只做最紧要功能：不做复杂规则引擎、不做统计、不做多页面工作流。
> 可选：一个简单“设置页/Options”用于少量配置。

---

## 2. MVP 范围（做 / 不做）

### 2.1 必做（MVP）

1. **下载列表（最近 N 条）**
2. **搜索（按文件名/域名）**
3. **基础筛选（状态/文件类型）**
4. **常用操作**

   * 打开文件（完成后）
   * 打开所在文件夹（完成后）
   * 重试（失败）
   * 取消（下载中）
   * 从列表移除（删除下载记录，不删文件）
5. **批量清理（轻量）**

   * 一键清理“已完成记录”
   * 一键清理“失败记录”
6. **界面美观（重点）**

   * 更紧凑、信息层级清晰、操作按钮不拥挤
   * 深色/浅色适配（至少跟随系统）

### 2.2 暂不做（后续）

* 自动归档/自动移动文件、重命名规则
* 标签、收藏、统计报表
* 云同步、多端一致性
* 删除本地文件（高风险 + 权限/平台差异大）

---

## 3. 用户故事（MVP）

* 作为用户，我想在弹窗里**立刻找到刚下载的文件**并打开。
* 我想按关键词搜索某个文件名，**不用进 Chrome 下载页**。
* 我下载失败了，希望能在弹窗里**一键重试**。
* 我希望列表**干净**：完成/失败的记录能一键清理。
* 我希望界面像你图里那样简单，但**更好看、更一致**。

---

## 4. 核心交互与界面结构（Popup）

### 4.1 Popup 规格

* 尺寸建议：宽 420–480px，高 560–640px（超出滚动）
* 打开插件默认展示：**最近下载**（按时间倒序）
* 首次打开加载：显示 skeleton（骨架屏）0.3–0.6s 提升质感

### 4.2 顶部区域（Header）

包含三部分：

1. **搜索框**（支持 `/` 快捷键聚焦）
2. **筛选器按钮**（状态、类型）
3. **更多菜单**（…）

   * 打开 Chrome 下载页
   * 设置
   * 一键清理：已完成记录 / 失败记录

### 4.3 列表项（Download Item Card）

每条下载项展示信息（保持精简但好看）：

**第一行（主信息）**

* 左侧：文件类型图标（按扩展名映射：pdf/doc/xls/zip/img/video/other）
* 中间：文件名（单行省略，hover 显示全名 tooltip）
* 右侧：状态胶囊（Completed / Downloading / Failed / Paused）

**第二行（副信息）**

* 域名（如 `example.com`） · 文件大小（如 `12.1MB`） · 时间（如 `14:39` 或 `昨天`）

**第三行（仅下载中/失败显示）**

* 下载中：细进度条 + `xx%` + 速度（可选）
* 失败：失败提示文案（简短）+ 重试按钮高亮

**操作区（右侧 hover 或常显，按密度模式）**

* 打开文件（完成）
* 定位文件夹（完成）
* 重试（失败）
* 取消（下载中）
* 移除记录（所有状态可用，删除 downloads 记录）

> 设计建议：默认只常显 2 个最常用按钮（打开/定位），其余 hover 出现，避免拥挤。

---

## 5. 功能需求（详细）

## 5.1 下载列表

### 5.1.1 数据来源

* 使用 `chrome.downloads.search()` 拉取
* 默认取最近 `N=50` 条（可配置 20/50/100）
* 支持分页/懒加载（滚动到底加载下一页；或一次拉够 100）

### 5.1.2 状态定义

* downloading（下载中）
* complete（已完成）
* interrupted（失败/中断）
* paused（暂停）——如果 API 能区分则展示；否则可不做

### 5.1.3 空状态

* 无下载记录：显示插画 + “去下载点什么吧”
* 搜索无结果：显示“没有匹配结果” + 清空搜索按钮

---

## 5.2 搜索

* 输入即过滤（300ms debounce）
* 匹配字段：

  * 文件名（filename 或 finalUrl 末段）
  * 域名（从 url 提取 host）
* 高亮匹配片段（增强可用性）
* 支持 ESC 清空搜索

---

## 5.3 筛选（MVP 简化）

### 5.3.1 状态筛选（单选）

* 全部
* 下载中
* 已完成
* 失败

### 5.3.2 类型筛选（单选）

* 全部
* 文档（pdf/doc/docx/ppt/pptx）
* 表格（xls/xlsx/csv）
* 图片（png/jpg/webp/gif/svg）
* 压缩包（zip/rar/7z）
* 安装包（exe/dmg/pkg）
* 其他

> MVP 先做**单选**就够了，多选留到后续。

---

## 5.4 操作能力

### 5.4.1 单条操作（按钮/菜单）

1. **打开文件**

   * 条件：`state=complete` 且文件存在（若打不开提示“文件可能已移动/删除”）
2. **打开所在文件夹**

   * 条件：同上
3. **重试**

   * 条件：`state=interrupted`（失败）
4. **取消**

   * 条件：`state=downloading`
5. **移除记录**

   * 使用 `chrome.downloads.erase({id})`
   * 需二次确认（轻提示也行）：

     * 方式 A：点击后 toast 可撤销（推荐，体验更高级）
     * 方式 B：简单 confirm（实现快但不够美观）

### 5.4.2 批量清理（MVP）

从“更多菜单”进入：

* 清理已完成记录（erase 所有 state=complete）
* 清理失败记录（erase 所有 state=interrupted）
* 清理全部记录（可选，强确认）

> 注意：MVP 不提供“删除本地文件”，只删记录更安全。

---

## 6. UI 美观与规范（重点落地）

## 6.1 视觉风格建议（直接可用）

* 整体：圆角 12–16，轻阴影，卡片列表
* 字体层级：

  * 文件名：14–15px semi-bold
  * 副信息：12px、灰度降低
  * 状态胶囊：11–12px，小而清晰
* 交互：

  * Hover 卡片轻微浮起（2–4px 阴影增强）
  * 按钮统一为 icon button（圆形/胶囊），hover 才显示更多按钮
* 主题：

  * 跟随系统浅色/深色
  * 状态色保持克制（失败红、进行中蓝、完成绿/灰）

## 6.2 组件清单（MVP）

* SearchInput
* FilterChips（状态、类型）
* DownloadList
* DownloadItemCard
* IconButtons（open / folder / retry / cancel / remove）
* Toast（撤销 / 提示）
* SkeletonLoader
* EmptyState

---

## 7. 设置（可选但推荐，极简）

一个 Options 页面（或者 popup 内齿轮弹窗也行）：

* 列表显示条数：20 / 50 / 100
* 默认筛选：全部/仅下载中（适合“下载监控”用户）
* 是否显示速度/剩余时间（默认关）
* 是否启用“移除记录后可撤销”（默认开）

---

## 8. 权限与技术约束（必须写清楚）

### 8.1 需要的权限

* `downloads`：读取列表、打开文件、重试、取消、移除记录
* `downloads.open`（如需要打开文件）
* `storage`：保存设置
* （可选）`notifications`：如果后续想做下载完成/失败通知（MVP 可不加）

### 8.2 关键限制

* 插件一般**不直接移动/重命名本地文件**（除非结合 Native Messaging 或用户手动路径策略），MVP 不碰
* “打开文件失败”场景要提示：文件可能已被移动/删除

---

## 9. 异常与边界

* 下载项没有文件名：从 URL 末段兜底展示
* 域名为空（本地 file:// 或 blob）：显示“本地/未知来源”
* 失败原因无法获取：统一显示“下载中断，可尝试重试”
* 快速连续操作：按钮禁用 + loading 状态，避免重复触发
* 权限缺失：首次安装引导页提示权限用途（简短可信）

---

## 10. 验收标准（MVP）

1. Popup 打开后 1s 内展示最近下载列表（至少骨架屏过渡）
2. 搜索能在 300ms 内响应，结果正确
3. 状态筛选/类型筛选准确
4. 完成项：可打开文件、可打开所在文件夹
5. 失败项：可一键重试
6. 下载中：可取消
7. 一键清理已完成/失败记录可用，并有明确提示（toast/confirm）
8. UI：浅色/深色下布局不崩，按钮对齐、间距一致、滚动体验顺滑

---

## 11. 后续迭代路线（你后面想加再加）
* V1.1：批量选择 + 批量移除/重试
* V1.2：收藏/置顶、按域名分组
* V2：规则（按类型/域名自动归类），但移动文件需要更强方案
---
